{"ast":null,"code":"import axios from 'axios';\nimport { getItem } from '../utils/webStorage';\nimport store from '../store/store';\nimport ActionCreator from '../store/actionCreator'; // Add a request interceptor\n\naxios.interceptors.request.use(function (config) {\n  // Do something before request is sent\n  //从缓存获取token 添加\n  config.data.token = getItem('token') || '';\n  console.log(config);\n  return config;\n}, function (error) {\n  // Do something with request error\n  return Promise.reject(error);\n}); // Add a response interceptor\n\naxios.interceptors.response.use(function (response) {\n  // Do something with response data\n  let list = [-996, -997, -998, -999];\n\n  if (list.indexOf(response.data.err) !== -1) {\n    // token 出问题了\n    console.log('token 出问题了', response.data.err);\n    store.dispatch(ActionCreator.setTokenModal(true));\n    return Promise.reject(response);\n  }\n\n  return response.data;\n}, function (error) {\n  // Do something with response error\n  return Promise.reject(error);\n});\nexport default axios;","map":{"version":3,"sources":["C:/farm/farm/farm-system/src/utils/axios.js"],"names":["axios","getItem","store","ActionCreator","interceptors","request","use","config","data","token","console","log","error","Promise","reject","response","list","indexOf","err","dispatch","setTokenModal"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,OAAR,QAAsB,qBAAtB;AACA,OAAOC,KAAP,MAAmB,gBAAnB;AACA,OAAOC,aAAP,MAA2B,wBAA3B,C,CACA;;AACAH,KAAK,CAACI,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,UAAUC,MAAV,EAAkB;AAC/C;AACA;AACAA,EAAAA,MAAM,CAACC,IAAP,CAAYC,KAAZ,GAAkBR,OAAO,CAAC,OAAD,CAAP,IAAkB,EAApC;AACAS,EAAAA,OAAO,CAACC,GAAR,CAAYJ,MAAZ;AACA,SAAOA,MAAP;AACD,CAND,EAMG,UAAUK,KAAV,EAAiB;AAClB;AACA,SAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CATD,E,CAWA;;AACAZ,KAAK,CAACI,YAAN,CAAmBW,QAAnB,CAA4BT,GAA5B,CAAgC,UAAUS,QAAV,EAAoB;AAClD;AACA,MAAIC,IAAI,GAAC,CAAC,CAAC,GAAF,EAAM,CAAC,GAAP,EAAW,CAAC,GAAZ,EAAgB,CAAC,GAAjB,CAAT;;AACA,MAAGA,IAAI,CAACC,OAAL,CAAaF,QAAQ,CAACP,IAAT,CAAcU,GAA3B,MAAkC,CAAC,CAAtC,EAAwC;AACtC;AACAR,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAAyBI,QAAQ,CAACP,IAAT,CAAcU,GAAvC;AACAhB,IAAAA,KAAK,CAACiB,QAAN,CAAehB,aAAa,CAACiB,aAAd,CAA4B,IAA5B,CAAf;AAEA,WAAOP,OAAO,CAACC,MAAR,CAAeC,QAAf,CAAP;AACD;;AACD,SAAOA,QAAQ,CAACP,IAAhB;AACD,CAXD,EAWG,UAAUI,KAAV,EAAiB;AAClB;AACA,SAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,CAdD;AAgBA,eAAeZ,KAAf","sourcesContent":["import axios from 'axios'\r\nimport {getItem} from '../utils/webStorage'\r\nimport store from  '../store/store'\r\nimport ActionCreator from  '../store/actionCreator'\r\n// Add a request interceptor\r\naxios.interceptors.request.use(function (config) {\r\n  // Do something before request is sent\r\n  //从缓存获取token 添加\r\n  config.data.token=getItem('token')||''\r\n  console.log(config)\r\n  return config;\r\n}, function (error) {\r\n  // Do something with request error\r\n  return Promise.reject(error);\r\n});\r\n\r\n// Add a response interceptor\r\naxios.interceptors.response.use(function (response) {\r\n  // Do something with response data\r\n  let list=[-996,-997,-998,-999]\r\n  if(list.indexOf(response.data.err)!==-1){\r\n    // token 出问题了\r\n    console.log('token 出问题了',response.data.err)\r\n    store.dispatch(ActionCreator.setTokenModal(true))\r\n\r\n    return Promise.reject(response);\r\n  }\r\n  return response.data;\r\n}, function (error) {\r\n  // Do something with response error\r\n  return Promise.reject(error);\r\n});\r\n\r\nexport default axios\r\n"]},"metadata":{},"sourceType":"module"}